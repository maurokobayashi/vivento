{"ts":1363035838076,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"#encoding: utf-8\nclass PeopleController < ApplicationController\n\n    before_filter :require_authentication, only: [:create, :index, :show, :edit, :update, :destroy]\n    before_filter :require_admin_or_private, only: [:edit, :update, :destroy]\n\n    def index\n        @people = Person.paginate(page: params[:page])\n    end\n\n    def show\n        @person = Person.find params[:id]\n    end\n\n    def new\n        @person = Person.new\n    end\n\n    def create\n        @person = Person.new params[:person]\n        @person.user_id = current_user.id\n        if @person.save\n            flash[:success] = (@person.is_admin? ? \"Síndico\" : \"Morador\") + \" '#{@person.name}' cadastrado.\"\n            redirect_to @person\n        else\n            flash[:error] = \"Não foi possível cadastrar morador. Preencha os campos obrigatórios.\"\n            render 'new'\n        end\n    end\n\n    def edit\n        @person = Person.find params[:id]\n    end\n\n    def update\n        @person = Person.find params[:id]\n        if @person.update_attributes params[:person]\n            flash[:success] = \"Seus dados foram atualizados.\"\n            sign_in @person.user\n            redirect_to @person\n        else\n            flash[:error] = \"Não foi possível atualizar seus dados. Preencha os campos obrigatórios.\"\n            render 'edit'\n        end\n    end\n\n    def destroy\n        person = Person.find(params[:id]).destroy\n        if current_user?(person.user)\n            flash[:success] = \"#{person.name}, sua conta foi excluída. Caso queira reativa-la, clique aqui.\"\n            redirect_to root_path\n        else\n            flash[:success] = \"A conta do usuário '#{person.name} <#{person.user.email}>' foi excluída.\"\n            redirect_to people_url\n        end\n    end\n\nend"]],"start1":0,"start2":0,"length1":0,"length2":1748}]],"length":1748}
{"contributors":[],"silentsave":false,"ts":1363035853609,"patch":[[{"diffs":[[0,":page])\n    "],[-1,"end\n"],[1,"\n    "],[0,"\n    def sho"]],"start1":305,"start2":305,"length1":28,"length2":29}]],"length":1749,"saved":false}
{"ts":1363035856510,"patch":[[{"diffs":[[0,":page])\n    "],[1,"end"],[0,"\n    \n    de"]],"start1":305,"start2":305,"length1":24,"length2":27}]],"length":1752,"saved":false}
